#include <U8glib.h>

U8GLIB_SH1106_128X64 u8g(U8G_I2C_OPT_NONE);  // I2C / TWI 

int switchPin = 2; // 滑動開關的腳位
int potPin = A0; // 可變電阻的腳位
int switchState = 0; // 滑動開關的狀態
unsigned long timer = 0; // 計時器
int minutes = 0; // 分鐘
int seconds = 0; // 秒數

void setup(void) {
  pinMode(switchPin, INPUT);
}

void loop(void) {
  switchState = digitalRead(switchPin);
  if (switchState == HIGH) {
    displayTimer();
  } else {
    displayVoltage();
  }
}

void displayTimer() {
  u8g.firstPage();  
  do {
    u8g.setFont(u8g_font_unifont);
    char timerText[6];
    sprintf(timerText, "%02d:%02d", minutes, seconds);
    u8g.drawStr(32, 30, timerText);
    u8g.drawStr(10, 60, "YOUR_STUDENT_ID"); // 將 YOUR_STUDENT_ID 替換成你的學號
  } while( u8g.nextPage() );
  if (millis() - timer >= 1000) {
    timer = millis();
    seconds++;
    if (seconds >= 60) {
      seconds = 0;
      minutes++;
    }
  }
}

void displayVoltage() {
  u8g.firstPage();  
  do {
    u8g.setFont(u8g_font_unifont);
    int sensorValue = analogRead(potPin);
    float voltage = map(sensorValue, 0, 1023, 0, 5);
    char voltageText[6];
    sprintf(voltageText, "%.2f V", voltage);
    u8g.drawStr(32, 30, voltageText);
  } while( u8g.nextPage() );
}
